<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>ALFA Testing framework</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>ALFA Testing framework</h1>
<div class="details">
<span id="revnumber">version 1.0.8</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_changelog">Changelog</a></li>
<li><a href="#_support">Support</a></li>
<li><a href="#JavaReq">Java Requirement</a></li>
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_project_structure">Project structure</a>
<ul class="sectlevel2">
<li><a href="#_quick_start_in_visual_studio_code">Quick start in Visual Studio Code</a></li>
</ul>
</li>
<li><a href="#_authorization_domain_v2_directory_layout_convention">Authorization domain V2 directory layout convention</a>
<ul class="sectlevel2">
<li><a href="#DomainV2MoreInformation">More information</a></li>
</ul>
</li>
<li><a href="#_using_the_alfa_test_framework">Using the ALFA Test framework</a>
<ul class="sectlevel2">
<li><a href="#_dictionary">Dictionary</a></li>
<li><a href="#_creating_attributes">Creating attributes</a></li>
<li><a href="#_creating_tests">Creating tests</a></li>
<li><a href="#_creating_policies">Creating policies</a></li>
<li><a href="#_creating_attribute_connectors">Creating attribute connectors</a></li>
</ul>
</li>
<li><a href="#testing_alfa_policies">Testing ALFA policies</a>
<ul class="sectlevel2">
<li><a href="#_creating_the_junit_test">Creating the junit test</a></li>
<li><a href="#set_policy_under_test">Set policy under test</a></li>
<li><a href="#_with_attribute_connectors">With Attribute Connectors</a></li>
<li><a href="#_execute_test_request_and_assert_result">Execute test request and assert result</a></li>
</ul>
</li>
<li><a href="#_testing_obligations_and_advice">Testing Obligations and Advice</a>
<ul class="sectlevel2">
<li><a href="#_testing_attribute_connectors">Testing Attribute Connectors</a></li>
</ul>
</li>
<li><a href="#running_test_against_a_remote_service">Running test against a remote service</a>
<ul class="sectlevel2">
<li><a href="#_create_a_remote_test_target_task">Create a remote test target task</a></li>
<li><a href="#_environment_variables_for_controlling_remote_test_execution">Environment variables for controlling remote test execution</a></li>
<li><a href="#_extra_headers">Extra headers</a></li>
</ul>
</li>
<li><a href="#_variable_substitution">Variable substitution</a>
<ul class="sectlevel2">
<li><a href="#_variables_in_test_data">Variables in test data</a></li>
<li><a href="#_defining_variables">Defining variables</a></li>
</ul>
</li>
<li><a href="#Gradle">Gradle</a>
<ul class="sectlevel2">
<li><a href="#GradleConfiguration">Configuration</a></li>
<li><a href="#_tasks">Tasks</a></li>
<li><a href="#DependencyConfiguration">Dependency configurations</a></li>
</ul>
</li>
<li><a href="#_debugging">Debugging</a>
<ul class="sectlevel2">
<li><a href="#RequestAndResponse">Request and responses</a></li>
<li><a href="#_tracing">Tracing</a></li>
</ul>
</li>
<li><a href="#_peps_and_sending_requests">PEPs and sending requests</a>
<ul class="sectlevel2">
<li><a href="#_curl_with_json_body">Curl with JSON body</a></li>
<li><a href="#_openapi">OpenAPI</a></li>
<li><a href="#_sample_ava_pep_implementation">Sample ava PEP implementation</a></li>
<li><a href="#_reference_documentation">Reference documentation</a></li>
</ul>
</li>
<li><a href="#_docker">Docker</a></li>
<li><a href="#_axiomatics_service_manager_integration">Axiomatics Service Manager integration</a></li>
<li><a href="#_reference_and_further_documentation">Reference and further documentation</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ALFA Testing Framework tool is a Gradle project and JUnit4 extension to develop and test ALFA policies, attribute connectors and your entire authorization/Attribute Based Access Control (ABAC) domain.</p>
</div>
<div class="paragraph">
<p>An ALFA project can be a fundamental part in achieving DevOps and a CI/CD pipeline of ALFA and Attribute Based Access Control (ABAC) and can be integrated into your organizations available build tools (such as Jenkins, Azure DevOps or OpenShift).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Please note that this project currently needs to be run with Java 11.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://docs.gradle.org/current/userguide/what_is_gradle.html">Gradle</a> is a build automation tool that integrates well with build severs like Jenkins.</p>
</div>
<div class="paragraph">
<p>This tool provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unit and white box testing of individual ALFA Policies</p>
</li>
<li>
<p>Integration testing of multiple policies and/or policy combination algorithms</p>
</li>
<li>
<p>System testing of the main policy</p>
</li>
<li>
<p>Be configured to run with or without attribute connectors</p>
</li>
<li>
<p>Test attribute connectors in isolation as a unit</p>
</li>
<li>
<p>Platform or accepting testing by executing the system tests towards an external ADS service</p>
</li>
<li>
<p>Supports externalizing runtime configuration to the environment, to be able to reuse tests from a local developer&#8217;s laptop all the way up to system test of a production environment.</p>
</li>
<li>
<p>Supports externalizing logical configuration (parametrized tests) to the environment, to be able to handle different test data sets in different environments</p>
</li>
<li>
<p>Resolve external policies from Maven-like repository</p>
</li>
<li>
<p>Building a docker image</p>
</li>
<li>
<p>Push a domain to Axiomatics Service Manager or Axiomatics Domain Manager</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This tool aims at letting you treat ALFA policies as code to implement a Test Driven Development (TDD) approach to Attribute Based Access Control (ABAC).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changelog">Changelog</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First public release</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">More attribute verifications based on feedback</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed NPE due to missing method implementation in context stub class</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added possibility to resolve external policies via configuration <em>policy</em>. Added possibity to push domain to ASM.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Documentation last update: 2022-06-10</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_support">Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use your normal Axiomatics support channel for support, bug reports or feature requests.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="JavaReq">Java Requirement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java 11 is required to compile and run this project.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Install Axiomatics repository key for access to Axiomatics' Maven repository in file <em>gradle.properties</em> or set the environment variables with the same names:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>AXIOMATICS_ACCESS_KEY_ID=&lt;key_id&gt;
AXIOMATICS_SECRET_ACCESS_KEY=&lt;access_key&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy your software license file axiomatics_PDP.license to the <em>license/</em> directory.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project_structure">Project structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The root directory contains a Gradle example project. It consists of:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directory/File</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/authorizationDomain/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sources for the authorization domain (ALFA policies and attribute connector configuration) as outlined in <a href="#_authorization_domain_v2_directory_layout_convention">Authorization domain V2 directory layout convention</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/test/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policies and attribute connectors tests written in Java.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">buildSrc/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Axiomatics internal script to bootstrap the projects. Should not be modified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">extra/documentation/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project documentation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">extra/exampleRequests/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example of sending requests using curl</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gradle/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle internal files. Should not be modified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">license/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Place for Axiomatics ADS license file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">build.gradle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project configuration</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_quick_start_in_visual_studio_code">Quick start in Visual Studio Code</h3>
<div class="paragraph">
<p>The sample ALFA project can be loaded and worked with as any other software project. This section show how to do that in Visual Studio Code, but you can use any other Integrated Developer Environment (IDEs) that integrates with Gradle and Java.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Note if you are asked to install a Java or JDK, please choose a version listed in  <a href="#JavaReq">Java Requirement</a>.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install necessary extensions in Visual Studio Code:</p>
<div class="ulist">
<ul>
<li>
<p>Install <a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-gradle">Gradle for Java</a></p>
</li>
<li>
<p>Install <a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack">Extension Pack for Java</a></p>
</li>
<li>
<p>Install <a href="https://marketplace.visualstudio.com/items?itemName=Axiomatics.alfa">Visual Studio Code extension for ALFA</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>In Visual Studio Code, chose Open Folder and select this project folder. After the project has loaded you should see the project in <em>Java Projects</em> section under the <em>Explorer</em> activity.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="main.alfa-project-VisualStudioCode.png" alt="ALFA Project in Visual Studio Code">
</div>
</div>
<div class="paragraph">
<p>The ALFA policies and attribute dictionary are located under <em>src/authorizationDomain</em>.</p>
</div>
<div class="sect3">
<h4 id="_run_tests">Run tests</h4>
<div class="paragraph">
<p>Select the <em>Testing</em> activity from the activity bar. You can run the tests by pressing the play icon when hovering over my-alfa-project. For a full reference on the gradle tasks, see <a href="#Gradle">Gradle</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="project-VisualStudioCode-test.png" alt="Testing in Visual Studio Code">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_build_authorization_domain">Build authorization domain</h4>
<div class="paragraph">
<p>From the <em>Gradle</em> activity the authorization domain can be built by target <em>axiomaitcs&#8594;buildAuthzDomain</em>. The authorization domain configuration will be written to <em>build/alfa/domain/ads</em>  as domain.yaml. This file can be referred to by an Axiomatics Decision Service&#8217;s (ADS) deployment descriptor. See <a href="#Running ADS">[Running ADS]</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="project-VisualStudioCode-build.png" alt="Build authorization domain in Visual Studio Code">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authorization_domain_v2_directory_layout_convention">Authorization domain V2 directory layout convention</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The use of this framework requires your ALFA project and directories to be setup accordingly to Domain v2 format.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/authorizationDomain/alfaSpecifications</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory for ALFA policies and attributes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/authorizationDomain/attributeConnectors</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory for attribute connectors</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deployment.yaml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The deployment descriptor for ADS (<a href="https://docs.axiomatics.com/access-decision-service/">reference</a>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/authorizationDomain/attributes.yaml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute definitions of all attributes that are resolved via a attribute connector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/authorizationDomain/attributeCache.yaml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration of attribute caches.</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="DomainV2MoreInformation">More information</h3>
<div class="paragraph">
<p>For full reference, see <a href="auth_domain_v2_layout_convention.html">Authorization domain V2 directory layout convention</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_alfa_test_framework">Using the ALFA Test framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes a workflow to create an authorization domain with ALFA policies and attribute connectors to your PIPs. A full example is also provided in the src/ folder.</p>
</div>
<div class="paragraph">
<p>Before starting with implementation of your authorization domain, capture your business requirements for authorization in an existing tool that you have (JIRA, Confluence, Excel). Extract the necessary attributes to implement such requirements and specify them in an attribute dictionary.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>id</em> is a reserved keyword in <a href="https://docs.axiomatics.com/access-decision-service/authorization-domains/using-a-yaml-domain/#the-attributes-section">ALFA</a> and can not be used in attribute names.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_dictionary">Dictionary</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Attribute dictionary</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name (namespace+id)</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Responsible/SLA</th>
<th class="tableblock halign-left valign-top">Cardinality</th>
<th class="tableblock halign-left valign-top">Reference</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">acme.user.identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- (PEP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HR AD, 6 character alphanum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Acme employee signature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">johsmi, jandoe</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">acme.customer.identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- (PEP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0&#8230;&#8203;*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Salesforce customer id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The customer(s) involved in action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">231698, 249111</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">acme.customer.location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Salesforce customer PIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">acme.customer.identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business Operation team, 99%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0&#8230;&#8203;*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 3166-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer origin country</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SE, US</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_creating_attributes">Creating attributes</h3>
<div class="paragraph">
<p>Attributes need to be defined in dictionaries before they can be used in an ALFA policy or Attribute Connector. There are two dictionaries that needs to be populated. <em>src\authorizationDomain\alfaSpecifications\attributes.alfa</em> contains attributes used in ALFA policies and in tests. <em>src\authorizationDomain\attributes.yaml</em> contains attributes that are used as output from Attribute Connectors.</p>
</div>
<div class="sect3">
<h4 id="_policy_attributes">Policy attributes</h4>
<div class="paragraph">
<p>To use an attribute in ALFA policy or in a Junit test define it in an ALFA file inside the authorizationDomain directory. Organize your attribute in namespaces hierarchies as needed.</p>
</div>
<div class="paragraph">
<p>Type is the JSON shorthand type code defined <a href="http://docs.oasis-open.org/xacml/xacml-json-http/v1.0/cos01/xacml-json-http-v1.0-cos01.html#_Toc497727075">here.</a></p>
</div>
<div class="paragraph">
<p>Category is any of: <em>subjectCat, resourceCat, actionCat or environmentCat</em> and defines if the attribute is a property of a subject (such as role) or  resource (such as owner) etc.</p>
</div>
<div class="paragraph">
<p>The id can for convenience always be set to namespaces concatenated with a dot plus the attribute name.</p>
</div>
<div class="paragraph">
<p>The format of this file is ALFA.</p>
</div>
<div class="listingblock">
<div class="title">attributes.alfa</div>
<div class="content">
<pre class="CodeRay highlight"><code>namespace acme {
       namespace user {
        attribute role {
            id = &quot;acme.user.role&quot;
            type = string
            category = subjectCat
        }
    }

    namespace resource {
        attribute location {
            id = &quot;acme.resource.location&quot;
            type = string
            category = resourceCat
        }

        attribute identity {
            id = &quot;acme.resource.identity&quot;
            type = string
            category = resourceCat
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_attributes_yaml">attributes.yaml</h4>
<div class="paragraph">
<p>Attributes that are resolved by an Attribute Finder (and thus can is cachable) needs to be defined in the attribute.yaml file. This file is YAML format. More information <a href="https://docs.axiomatics.com/access-decision-service/authorization-domains/using-a-yaml-domain/#the-attributes-section">here</a>.</p>
</div>
<div class="paragraph">
<p>Category is any of: <em>AccessSubject, Resource, Action or Environment</em> and defines if the attribute is a property of a subject (such as role) or  resource (such as owner) etc.</p>
</div>
<div class="paragraph">
<p>The xacmlId can for convenience always be set to namespaces concatenated with a dot plus the attribute name.</p>
</div>
<div class="paragraph">
<p>The format of this file is YAML.</p>
</div>
<div class="listingblock">
<div class="title">attributes.yaml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">acme.user.role</span>:
  <span class="key">xacmlId</span>: <span class="string"><span class="content">acme.user.role</span></span>
  <span class="key">category</span>: <span class="string"><span class="content">AccessSubject</span></span>
  <span class="key">datatype</span>: <span class="string"><span class="content">string</span></span>
<span class="key">acme.user.location</span>:
  <span class="key">xacmlId</span>: <span class="string"><span class="content">acme.user.location</span></span>
  <span class="key">category</span>: <span class="string"><span class="content">AccessSubject</span></span>
  <span class="key">datatype</span>: <span class="string"><span class="content">string</span></span>
<span class="key">acme.resource.location</span>:
  <span class="key">xacmlId</span>: <span class="string"><span class="content">acme. resource.location</span></span>
  <span class="key">category</span>: <span class="string"><span class="content">Resource</span></span>
  <span class="key">datatype</span>: <span class="string"><span class="content">string</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_tests">Creating tests</h3>
<div class="paragraph">
<p>We advocate test-driven development (<a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD</a>) of ALFA and your authorization domain. This means that before you are allowed to write any effective code (that would your ALFA policies) you must first write and run a test that fails. So, go ahead and write a unit test that fails. See <a href="#testing_alfa_policies">Testing ALFA policies</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_policies">Creating policies</h3>

</div>
<div class="sect2">
<h3 id="_creating_attribute_connectors">Creating attribute connectors</h3>
<div class="paragraph">
<p>Attribute Connectors connects the decision service (Axiomatics component ADS or PDP) with external Policy Information Points (PIPs). With the help of attribute connectors the decision service can in runtime call out to your business services to fetch a user&#8217;s role, for example. It is possible to cache these attribute values.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Based on a value of a key attribute, an attribute connector enables the decision engine to call out to an external source (the PIP), to fetch values for another attribute.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_attribute_connector_description_file">Attribute Connector description file</h4>
<div class="paragraph">
<p>In the authorizationDomain/attributeConnectors directory, create a new Attribute Connector deployment descriptor file.</p>
</div>
<div class="listingblock">
<div class="title">my_connector.configurationString.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">className</span>: <span class="string"><span class="content">&lt;class name&gt;</span></span>
<span class="key">provides</span>:
  - <span class="string"><span class="content">&lt;attribute name&gt;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The table below lists the built in Attribute Connectors available.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute Connector</th>
<th class="tableblock halign-left valign-top">Class name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.axiomatics.acs.plugin.pips.ldap.LdapPipModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.axiomatics.acs.plugin.pips.sql.SqlPipModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.axiomatics.acs.plugin.pips.table.TablePipModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.axiomatics.cr.pip.constant.ConstantAttributeConnector</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Http (REST or SOAP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.axiomatics.pip.http.HttpPIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parser (JSON or XML)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.axiomatics.pip.parser.ParserPIP</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The next sections outline example configuration for respective connector. These are just an example and each connector&#8217;s own
documentation can be consulted for detailed information. See <a href="https://docs.axiomatics.com">docs.axiomatics.com</a> and
<a href="https://support.axiomatics.com">support.axiomatics.com</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ldap">LDAP</h4>
<div class="listingblock">
<div class="title">my_connector.configurationString.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;pip:configuration</span> <span class="attribute-name">xmlns:pip</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/ldap.config</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/ldap.config ldap.config.xsd </span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;pip:connnection&gt;</span>
    <span class="tag">&lt;pip:key</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.naming.factory.initial</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.sun.jndi.ldap.LdapCtxFactory</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;pip:key</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.naming.security.credentials</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">´${AC_LDAP1_PASSWORD:-secret}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;pip:key</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.naming.security.principal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${AC_LDAP1_USERNAME:-uid=admin,ou=system}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;pip:key</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.naming.security.authentication</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">simple</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;pip:key</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.naming.provider.url</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${AC_LDAP1_URL:-ldap://10.0.1.196:10389}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/pip:connnection&gt;</span>
  <span class="tag">&lt;pip:mapping&gt;</span>
    <span class="tag">&lt;pip:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">acme.role</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;pip:nativeAttribute&gt;</span>
      <span class="tag">&lt;pip:searchSelection&gt;</span>sn<span class="tag">&lt;/pip:searchSelection&gt;</span>
      <span class="tag">&lt;pip:searchBase&gt;</span>dc=axiomatics,dc=com<span class="tag">&lt;/pip:searchBase&gt;</span>
      <span class="tag">&lt;pip:searchBaseKey&gt;</span><span class="tag">&lt;pip:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject:subject-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/pip:searchBaseKey&gt;</span>
      <span class="tag">&lt;pip:searchScope&gt;</span>2<span class="tag">&lt;/pip:searchScope&gt;</span>
      <span class="tag">&lt;pip:searchFilter&gt;</span>cn=?<span class="tag">&lt;/pip:searchFilter&gt;</span>
      <span class="tag">&lt;pip:key</span> <span class="attribute-name">allowMultiple</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;pip:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">acme.username</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/pip:key&gt;</span>
    <span class="tag">&lt;/pip:nativeAttribute&gt;</span>
  <span class="tag">&lt;/pip:mapping&gt;</span>
<span class="tag">&lt;/pip:configuration&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sql">SQL</h4>
<div class="listingblock">
<div class="title">my_connector.configurationString.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;cfg:configuration</span> <span class="attribute-name">xmlns:cfg</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/jdbc.config</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/jdbc.config jdbc.config.xsd </span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;cfg:connnection&gt;</span>
          <span class="tag">&lt;cfg:url&gt;</span>jdbc:postgresql://localhost/usda?user=usda<span class="entity">&amp;amp;</span>password=password<span class="tag">&lt;/cfg:url&gt;</span>
          <span class="tag">&lt;cfg:driver&gt;</span>org.postgresql.Driver<span class="tag">&lt;/cfg:driver&gt;</span>
  <span class="tag">&lt;/cfg:connnection&gt;</span>
  <span class="comment">&lt;!-- mapping for allergy test --&gt;</span>
  <span class="tag">&lt;cfg:mapping&gt;</span>
    <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">food-group-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;cfg:nativeAttribute&gt;</span>
      <span class="tag">&lt;cfg:sqlType&gt;</span>2004<span class="tag">&lt;/cfg:sqlType&gt;</span>
      <span class="tag">&lt;cfg:query&gt;</span>SELECT fddrp_desc FROM fd_group WHERE fdgrp_cd=?<span class="tag">&lt;/cfg:query&gt;</span>
      <span class="tag">&lt;cfg:key</span> <span class="attribute-name">allowMultiple</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">sqlType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">12</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">food-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/cfg:key&gt;</span>
    <span class="tag">&lt;/cfg:nativeAttribute&gt;</span>
    <span class="tag">&lt;cfg:uId&gt;</span>1<span class="tag">&lt;/cfg:uId&gt;</span>
  <span class="tag">&lt;/cfg:mapping&gt;</span>
  <span class="comment">&lt;!--  mapping for journal reading --&gt;</span>
  <span class="tag">&lt;cfg:mapping&gt;</span>
    <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">issue-year</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#integer</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;cfg:nativeAttribute&gt;</span>
      <span class="tag">&lt;cfg:sqlType&gt;</span>4<span class="tag">&lt;/cfg:sqlType&gt;</span>
      <span class="tag">&lt;cfg:query&gt;</span>SELECT year FROM data_src WHERE datasrc_id=?<span class="tag">&lt;/cfg:query&gt;</span>
      <span class="tag">&lt;cfg:key</span> <span class="attribute-name">allowMultiple</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">sqlType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">12</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:resource:resource-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/cfg:key&gt;</span>
    <span class="tag">&lt;/cfg:nativeAttribute&gt;</span>
    <span class="tag">&lt;cfg:uId&gt;</span>2<span class="tag">&lt;/cfg:uId&gt;</span>
  <span class="tag">&lt;/cfg:mapping&gt;</span>
  <span class="tag">&lt;cfg:mapping&gt;</span>
    <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">journal-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;cfg:nativeAttribute&gt;</span>
      <span class="tag">&lt;cfg:sqlType&gt;</span>2004<span class="tag">&lt;/cfg:sqlType&gt;</span>
      <span class="tag">&lt;cfg:query&gt;</span>SELECT journal FROM data_src WHERE datasrc_id=? GROUP BY journal<span class="tag">&lt;/cfg:query&gt;</span>
      <span class="tag">&lt;cfg:key</span> <span class="attribute-name">allowMultiple</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">sqlType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">12</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:resource:resource-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/cfg:key&gt;</span>
    <span class="tag">&lt;/cfg:nativeAttribute&gt;</span>
    <span class="tag">&lt;cfg:uId&gt;</span>3<span class="tag">&lt;/cfg:uId&gt;</span>
  <span class="tag">&lt;/cfg:mapping&gt;</span>
  <span class="tag">&lt;cfg:mapping&gt;</span>
    <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">subscribed-journal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;cfg:nativeAttribute&gt;</span>
      <span class="tag">&lt;cfg:sqlType&gt;</span>2004<span class="tag">&lt;/cfg:sqlType&gt;</span>
      <span class="tag">&lt;cfg:query&gt;</span>SELECT journal FROM data_src WHERE journal LIKE 'Journal of%'<span class="tag">&lt;/cfg:query&gt;</span>
    <span class="tag">&lt;/cfg:nativeAttribute&gt;</span>
    <span class="tag">&lt;cfg:uId&gt;</span>4<span class="tag">&lt;/cfg:uId&gt;</span>
  <span class="tag">&lt;/cfg:mapping&gt;</span>
  <span class="comment">&lt;!--  mapping for null bit test --&gt;</span>
  <span class="tag">&lt;cfg:mapping&gt;</span>
    <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">food_bit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;cfg:nativeAttribute&gt;</span>
      <span class="tag">&lt;cfg:sqlType&gt;</span>-7<span class="tag">&lt;/cfg:sqlType&gt;</span>
      <span class="tag">&lt;cfg:query&gt;</span>SELECT food_bit FROM fd_group WHERE fdgrp_cd=?<span class="tag">&lt;/cfg:query&gt;</span>
      <span class="tag">&lt;cfg:key</span> <span class="attribute-name">allowMultiple</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">sqlType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">12</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">food-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/cfg:key&gt;</span>
    <span class="tag">&lt;/cfg:nativeAttribute&gt;</span>
    <span class="tag">&lt;cfg:uId&gt;</span>5<span class="tag">&lt;/cfg:uId&gt;</span>
  <span class="tag">&lt;/cfg:mapping&gt;</span>
<span class="tag">&lt;/cfg:configuration&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sql_table">SQL Table</h4>
<div class="listingblock">
<div class="title">my_connector.configurationString.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;cfg:configuration</span> <span class="attribute-name">xmlns:cfg</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/table.config</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/table.config table.config.xsd </span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;cfg:connnection&gt;</span>
          <span class="tag">&lt;cfg:url&gt;</span>jdbc:postgresql://localhost/usda?user=usda<span class="entity">&amp;amp;</span>password=password<span class="tag">&lt;/cfg:url&gt;</span>
          <span class="tag">&lt;cfg:driver&gt;</span>org.postgresql.Driver<span class="tag">&lt;/cfg:driver&gt;</span>
  <span class="tag">&lt;/cfg:connnection&gt;</span>

  <span class="comment">&lt;!-- mapping for allergy test --&gt;</span>
  <span class="tag">&lt;cfg:mapping</span> <span class="attribute-name">isSingleValued</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">food-group-name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
         <span class="tag">&lt;cfg:tableName&gt;</span>food-group-table<span class="tag">&lt;/cfg:tableName&gt;</span>
         <span class="tag">&lt;cfg:columnName&gt;</span>food-group-name<span class="tag">&lt;/cfg:columnName&gt;</span>
    <span class="tag">&lt;cfg:key</span> <span class="attribute-name">allowMultiple</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;cfg:xacmlAttribute</span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">food-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:3.0:attribute-category:resource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;cfg:columnName&gt;</span>food-id<span class="tag">&lt;/cfg:columnName&gt;</span>
    <span class="tag">&lt;/cfg:key&gt;</span>
    <span class="tag">&lt;cfg:uId&gt;</span>1<span class="tag">&lt;/cfg:uId&gt;</span>
  <span class="tag">&lt;/cfg:mapping&gt;</span>

<span class="tag">&lt;/cfg:configuration&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_http_restjson_or_wssoap">HTTP (REST/JSON or WS/SOAP)</h4>
<div class="sect4">
<h5 id="_http">HTTP</h5>
<div class="listingblock">
<div class="title">my_connector.configurationString.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;configuration</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/http.config</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">identifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sample-unique-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;connection&gt;</span>
                <span class="tag">&lt;url&gt;</span>http://jsonplaceholder.typicode.com/posts/{0}<span class="tag">&lt;/url&gt;</span>
            <span class="tag">&lt;connectionKey&gt;</span>
                    <span class="tag">&lt;xacmlAttribute</span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.acme.user.employeeId</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/connectionKey&gt;</span>
                <span class="tag">&lt;method&gt;</span>GET<span class="tag">&lt;/method&gt;</span>
        <span class="tag">&lt;/connection&gt;</span>
        <span class="tag">&lt;mapping&gt;</span>
                <span class="tag">&lt;xacmlAttribute</span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pip.payload</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;contentType&gt;</span>application/json<span class="tag">&lt;/contentType&gt;</span>
        <span class="tag">&lt;/mapping&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_parser">Parser</h5>
<div class="listingblock">
<div class="title">my_connector.configurationString.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;configuration</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.axiomatics.com/parser.config</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">identifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">example-pip</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;mapping&gt;</span>
                <span class="tag">&lt;xacmlAttribute</span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pip.status</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;expression&gt;</span>$.title<span class="tag">&lt;/expression&gt;</span>
                <span class="tag">&lt;payload</span> <span class="attribute-name">contentType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;xacmlAttribute</span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">AttributeId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pip.payload</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">DataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema#string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Issuer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;/payload&gt;</span>
        <span class="tag">&lt;/mapping&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constant">Constant</h4>
<div class="listingblock">
<div class="title">my_connector.configurationString.yaml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">mappings</span>:
  - <span class="string"><span class="content">destination:</span><span class="content">
      category: AccessSubject
      datatype: string
      id: user.role</span></span>
    <span class="key">dictionary</span>:
      <span class="key">martin</span>: <span class="string"><span class="content">manager</span></span>
      <span class="key">cecilia</span>: <span class="string"><span class="content">consultant</span></span>
    <span class="key">source</span>:
      <span class="key">category</span>: <span class="string"><span class="content">AccessSubject</span></span>
      <span class="key">datatype</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">id</span>: <span class="string"><span class="content">user.identity</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_attribute_value_caching">Attribute value caching</h4>
<div class="listingblock">
<div class="title">attributeCache.yaml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">user.role</span>:
  <span class="key">timeToLive</span>: <span class="string"><span class="content">1 day</span></span>
  <span class="key">maxItems</span>: <span class="string"><span class="content">1000</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing_alfa_policies">Testing ALFA policies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A typical deployment with goal of going into production can have the following tests.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Test</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Who, Where</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy unit test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tests a specific policy for a use case in isolation without attribute connectors or other policies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local developer, pipeline before deploying</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute Connector unit test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tests that a specific Attribute Connector can reach out to an external PIP to retrieve attributes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local developer, pipeline before deploying</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy and Attribute connector integration test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tests that a specific policy for a use case works in integration with the Attribute Connectors it needs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local developer, pipeline before deploying</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policies integration test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tests that multiple usecases with multiple policies works in combination and that combination algorithms (policy priorities) are correct.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local developer, pipeline before deploying</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System/acceptance test</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pipeline after deploying, possibly exception production environment</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_creating_the_junit_test">Creating the junit test</h3>
<div class="paragraph">
<p>Create a java file under <em>src/test</em> and create new ALFA rule:</p>
</div>
<div class="listingblock">
<div class="title">acmeUnitTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.junit.Test</span>;
<span class="keyword">import</span> <span class="include">com.axiomatics.cr.alfa.test.junit.AlfaTestRule</span>;

        <span class="annotation">@Rule</span>
        <span class="directive">public</span> AlfaTestRule target = <span class="keyword">new</span> AlfaTestRule();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="set_policy_under_test">Set policy under test</h3>
<div class="paragraph">
<p>Set policy under test. This can either be set to your ALFA main policy or a specific policy, depending if this is a system test or integration/unit test. (See <a href="#running_test_against_a_remote_service">Running test against a remote service</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">target.withMainPolicy(<span class="string"><span class="delimiter">&quot;</span><span class="content">myOrg.Main</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_with_attribute_connectors">With Attribute Connectors</h3>
<div class="paragraph">
<p>Specify that all attribute connectors should be used during the test. Has no effect if test is being run against a remote service. Your attribute connectors are not added by default to the test enviornment. If you should add them or not depends on the test your are writing. Normally they should not be added for a unit test, but for integration and system tests.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are implementing a Policy unit test, you should not enable you attribute connectors, but simulate them in a controlled manner by specifying them as test input using the <em>.with(&#8230;&#8203;)</em> method.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> target.withAttributeConnectors();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_execute_test_request_and_assert_result">Execute test request and assert result</h3>
<div class="paragraph">
<p>Execute a test with the help of Hamcrest matchers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">com.axiomatics.cr.alfa.test.junit.matchers.AlfaMatchers.permit</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.CoreMatchers.is</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.CoreMatchers.not</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.MatcherAssert.assertThat</span>;

        TestResponse result = target.newTestRequest()
                .with(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">alice</span><span class="delimiter">&quot;</span></span>)
                .with(<span class="string"><span class="delimiter">&quot;</span><span class="content">action</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">read</span><span class="delimiter">&quot;</span></span>)
                .evaluate();

        assertThat(result, is(not(permit())));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_obligations_and_advice">Testing Obligations and Advice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Test Obligations or Advice. This will assert that the text is available in any Obligation or Advice.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> assertThat(result.getAdvice(), hasItem(withText(<span class="string"><span class="delimiter">&quot;</span><span class="content">Advice from PDP</span><span class="delimiter">&quot;</span></span>)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>To target a specific Obligation or Advice attribute use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> assertThat(result.getObligation(), hasItem(withIdAndText(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.obligation.message</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Obligation from PDP</span><span class="delimiter">&quot;</span></span>)));</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_testing_attribute_connectors">Testing Attribute Connectors</h3>
<div class="paragraph">
<p>An Attribute Connector can be unit tested. The name of the attribute connector is the same as the filename of the connector under /attributeConnectors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Rule</span>
<span class="directive">public</span> AlfaTestRule alfaRule = <span class="keyword">new</span> AlfaTestRule();

...

AttributeConnector target = alfaRule.newAttributeTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">roleConnector</span><span class="delimiter">&quot;</span></span>); // <b class="conum">(1)</b>

<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; result = target.lookup(<span class="string"><span class="delimiter">&quot;</span><span class="content">role</span><span class="delimiter">&quot;</span></span>).by(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>);

assertThat(result, hasItems(<span class="string"><span class="delimiter">&quot;</span><span class="content">manager</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">employee</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The string parameter for the attribte test is the name of the attribute connector, which is the filename of the definition under
<em>src/authorizationDomain/attributeConnectors</em>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running_test_against_a_remote_service">Running test against a remote service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The same tests that are run in your editor (which tests your ALFA policies) can also be run against a remote authorization service (Axiomatics ADS or PDP), either from your local computer or a build server (e.g. Jenkins or Azure Devops).</p>
</div>
<div class="sect2">
<h3 id="_create_a_remote_test_target_task">Create a remote test target task</h3>
<div class="paragraph">
<p>To create a new test target task in Gradle, add a new task (or modify one of the existing in the sample project:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task test_ProdEnvironment(<span class="key">type</span>: Test) {
    group <span class="string"><span class="delimiter">&quot;</span><span class="content">verification</span><span class="delimiter">&quot;</span></span>
    environment <span class="string"><span class="delimiter">&quot;</span><span class="content">ALFA_TEST_REMOTE_URL</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">http://abac.acme.com:8081/authorize</span><span class="delimiter">&quot;</span></span>
    environment <span class="string"><span class="delimiter">&quot;</span><span class="content">ALFA_TEST_REMOTE_USER</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">pdp-user</span><span class="delimiter">&quot;</span></span>
    environment <span class="string"><span class="delimiter">&quot;</span><span class="content">ALFA_TEST_REMOTE_PASSWORD</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
    environment <span class="string"><span class="delimiter">&quot;</span><span class="content">ALFA_TEST_REMOTE_HEADER_FILE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">headers.json</span><span class="delimiter">&quot;</span></span> // <b class="conum">(1)</b>

}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The header file for remote connection is optional. See <a href="#_extra_headers">Extra headers</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Because we can not control which policy is the main policy of the remote service (it is already started with a main policy), we need to define which tests are meaningful to run against the remote service. Do so by specifying the main policy of your authorization domain is in the <em>alfa</em> block in build.grade. Any test that is not targeting this policy will be ignored:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">alfa {
    mainpolicy = <span class="string"><span class="delimiter">&quot;</span><span class="content">acme.Main</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When executing the gradle task, all tests that are marked to be run with no main policy or marked to be run with the main policy specified the in <em>alfa</em> block above, will be executed. Other tests will be skipped(ignored).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A test is marked to be run using the withMainPolicy() method when creating the Alfa Junit rule. See <a href="#set_policy_under_test">Set policy under test</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Execution of test task targeting a production environment</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">[user@machine project]# ./gradlew test_ProdEnvironment

com.myorg.alfa.MyAttributeconnectorTest &gt; shouldGetRoleConsultantForCecilia PASSED

com.myorg.alfa.MyAttributeconnectorTest &gt; shouldGetRoleManagerForMartin PASSED

com.myorg.alfa.MyConsultantPolicyUnitTest &gt; shouldPermitIfUserAndResourceAreInSameLocation SKIPPED

com.myorg.alfa.MyConsultantPolicyUnitTest &gt; shouldNotPermitIfUserAndResourceAreInDifferentLocation SKIPPED

com.myorg.alfa.MySystemTest &gt; shouldGiveCeciliaAccessToResource1 PASSED

com.myorg.alfa.MySystemTest &gt; shouldGiveMartinAccessToResource1 PASSED

com.myorg.alfa.MySystemTest &gt; shouldNotGiveCeciliaAccessToResource2 PASSED</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_environment_variables_for_controlling_remote_test_execution">Environment variables for controlling remote test execution</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALFA_TEST_REMOTE_URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The url to a <a href="https://docs.oasis-open.org/xacml/xacml-rest/v1.1/xacml-rest-v1.1.html">XACML REST Version 1.1</a> service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http:/127.0.0.1:8081/authorize</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALFA_TEST_REMOTE_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username for authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>pdp-user</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALFA_TEST_REMOTE_PASSWORD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password for authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>secret</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALFA_TEST_REMOTE_HEADER_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A local json file with extra headers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="#_extra_headers">Extra headers</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_extra_headers">Extra headers</h3>
<div class="paragraph">
<p>In case the test client needs to send extra headers to the external service (for example if there is an intermediate API gateway), these headers can be specified in a separate JSON file and the location of file can be set in an environment variable (ALFA_TEST_REMOTE_HEADER_FILE). <a href="#_variable_substitution">Variable substitution</a> can be used in this file to externalize configuration.</p>
</div>
<div class="listingblock">
<div class="title">headers.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">Target-Environment</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">PROD</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">Secret-Header</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${SECRET_VALUE}</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_variable_substitution">Variable substitution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Just as Axiomatics Access Decision Service (ADS), the testing framework can do variable substation in policies, attribute connectors, test data and other configuration. Also, a default value can be provided. Examples, with and without default values</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code> ${PIP_URL}
 ${PIP_URL:-http://ldap.myorganization.com}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_variables_in_test_data">Variables in test data</h3>
<div class="paragraph">
<p>Variables can be used in tests to parametrize the data. This is useful if your policy infomration points (PIPs) does not contain the same data in different environments (dev and prod, for example).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> target.newTestRequest().with(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">${USER_WITH_ROLE_A:-Alice}</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_defining_variables">Defining variables</h3>
<div class="paragraph">
<p>Variables can be defined in your test task in the <em>build._gradle</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">task test_ProductionEnv(type: Test) {
    group <span class="string"><span class="delimiter">&quot;</span><span class="content">verification</span><span class="delimiter">&quot;</span></span>
    environment <span class="string"><span class="delimiter">&quot;</span><span class="content">USER_WITH_ROLE_A</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>
    environment <span class="string"><span class="delimiter">&quot;</span><span class="content">PIP_URL</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">http://productionldap.myorganization.com</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or specified from the command line the standard Bash way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ USER_WITH_ROLE_A=Bob PIP_PASSWORD=abc123 PIP_URL=http://ldapprod.acme.com ./gradlew test_ProductionEnv</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Gradle">Gradle</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="GradleConfiguration">Configuration</h3>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code>alfa {
    mainpolicy = &quot;acme.Main&quot; // <b class="conum">(1)</b>
    licenseFile = &quot;license/axiomatics_PDP.license&quot; // <b class="conum">(2)</b>
}
dependencies { // <b class="conum">(3)</b>

    policy &quot;com.acme:globalPolicy:1.0@alfa // <b class="conum">(4)</b>
    ads files('truststore.jks') // <b class="conum">(5)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Name of the policy to be used as the main policy when building the authorization domain</p>
</li>
<li>
<p>Location to Axiomatics PDP license file</p>
</li>
<li>
<p><a href="#DependencyConfiguration">Dependency Configuration</a></p>
</li>
<li>
<p>External policies can be put on configuration policy. Note that <em>@alfa</em> is needed</p>
</li>
<li>
<p>Extra runtime dependencies, such as keystores, can be put on <em>ads</em> configuration</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_tasks">Tasks</h3>
<div class="paragraph">
<p>The following Gradle tasks are available. They can be executed from your IDE, the command line or a build automation tool, such as Jenkins or Azure DevOps.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>test
buildAuthzDomain
stageDeploymentDescriptor
runAds</pre>
</div>
</div>
<div class="sect3">
<h4 id="_execute_the_tests">Execute the tests</h4>
<div class="listingblock">
<div class="content">
<pre>[user@machine project]# ./gradlew test</pre>
</div>
</div>
<div class="paragraph">
<p>A test report will be produced in <em>build/reports/tests/</em></p>
</div>
</div>
<div class="sect3">
<h4 id="_build_authorization_domain_2">Build  authorization domain</h4>
<div class="listingblock">
<div class="content">
<pre>[user@machine project]# ./gradlew buildAuthzDomain</pre>
</div>
</div>
<div class="paragraph">
<p>The authorization domain, containing policies and attribute connectors, will be written to <em>build/alfa/ads/domain.yaml</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_stage_ads_configuration">Stage ADS configuration</h4>
<div class="paragraph">
<p>Build and stage all files necessary for ADS to run. Files will be staged to <em>build/alfa/domain/ads</em>.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[user@machine project]# ./gradlew stageDeploymentDescriptor</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_ads">Run ADS</h4>
<div class="paragraph">
<p>Run the authorization domain in ADS:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In order to run ADS you need a valid software license specified, see <a href="#GradleConfiguration">Gradle Configuration</a>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>[user@machine project]# ./gradlew runAds</pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl+C to stop it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="DependencyConfiguration">Dependency configurations</h3>
<div class="paragraph">
<p>Dependency configuration in gradle is used to configure the classpath for different tasks.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any additional attribute connector dependencies. Axiomatics HTTP, Parser and Constant attribute connectors always available on this configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">testImplementation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any additional dependencies for executing tests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any additional dependencies for running ADS.
     policy</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Configurations <em>testImplementation</em> and <em>ads</em> extends from <em>pip</em>. To add a new dependency on the pip configuration:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code>dependencies {
    pip '&lt;group&gt;:&lt;name&gt;:&lt;version&gt;'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debugging">Debugging</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="RequestAndResponse">Request and responses</h3>
<div class="paragraph">
<p>For tests that have been executed against a remote service, the generated JSON reqeusts and received JSON responses can be found in /build/alfa/tests/authorizationDomain/trace directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tracing">Tracing</h3>
<div class="paragraph">
<p>For the tests that have executed against local ALFA files, an execution trace file can be found in <em>/build/alfa/tests/authorizationDomain/trace</em> directory. This format is Axiomatics specific and can be loaded in a separate application (Axiomatics PAP) or sent to Axiomatics support for further analysis if needed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_peps_and_sending_requests">PEPs and sending requests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_curl_with_json_body">Curl with JSON body</h3>
<div class="paragraph">
<p>When executing the Gradle test task, if the target is an external ADS, the request and response JSON will be saved in the build directory, see <a href="#RequestAndResponse">Request and responses</a>. These traces can be used as templates for application owners or other PEP responsible roles.</p>
</div>
</div>
<div class="sect2">
<h3 id="_openapi">OpenAPI</h3>
<div class="paragraph">
<p>Open API (previously known as Swagger Specification) of the API to send authorization requests to the Axiomatics Decision Service or any other PDP can be found at
<a href="https://github.com/axiomatics/xacml-3.0-authz-service-openapi-spec" class="bare">https://github.com/axiomatics/xacml-3.0-authz-service-openapi-spec</a>. OpenAPI specification can be used to generate clients by Swagger tools or imported directly into Postman for example.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sample_ava_pep_implementation">Sample ava PEP implementation</h3>
<div class="paragraph">
<p>An example Java PEP implementation can be found in
<a href="https://github.com/axiomatics/java-json-pep-sdk" class="bare">https://github.com/axiomatics/java-json-pep-sdk</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reference_documentation">Reference documentation</h3>
<div class="paragraph">
<p>THe XACML JSON reference documentation from OASIS is avaialble here
<a href="http://docs.oasis-open.org/xacml/xacml-json-http/v1.0/xacml-json-http-v1.0.html" class="bare">http://docs.oasis-open.org/xacml/xacml-json-http/v1.0/xacml-json-http-v1.0.html</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_docker">Docker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Docker image can be built with task <em>buildAdsDockerImage</em>. The image will be tagged '&lt;project-name&gt;:latest' in the local default registry. To push it to a remote repository, tag it for a remote repository and push it like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>docker tag my-alfa-project:latest myRemoteRegistry.com/my-alfa-project:1.0
docker push myRemoteRegistry.com/my-alfa-project:1.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/palantir/gradle-docker">com.palantir.gradle.docker</a> plugin is used to build the image.
The image will be built use the Dockerfile in the project root. You can customize it if you need.</p>
</div>
<div class="paragraph">
<p>By default, the following files are included in the docker image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configurations (dependencies) <em>ads</em>, <em>policy</em> and <em>pip</em></p>
</li>
<li>
<p>Ads license file</p>
</li>
<li>
<p>deployment.yaml</p>
</li>
<li>
<p>The authorization domain (policies and attribute connectors)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you need any additional files, add them on the <em>ads</em> configuration, for example:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
         ads files(<span class="string"><span class="delimiter">'</span><span class="content">truststore.jks</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_axiomatics_service_manager_integration">Axiomatics Service Manager integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The authorization domain can be pushed to Axiomatics Service Manager (ASM) 7 via the Axiomatics Domain Manager API (ADM)</p>
</div>
<div class="paragraph">
<p>To push the domain to ASM add a new task in the build.gradle file:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task pushToAdm(<span class="key">type</span>: AdmPush) {
    group <span class="string"><span class="delimiter">'</span><span class="content">axiomatics</span><span class="delimiter">'</span></span> <b class="conum">(1)</b>
    client_id <span class="string"><span class="delimiter">'</span><span class="content">ads1</span><span class="delimiter">'</span></span> <b class="conum">(2)</b>
    client_secret <span class="string"><span class="delimiter">'</span><span class="content">wBGbr79PXG3cyjgmFpJWMqnK842k3ene</span><span class="delimiter">'</span></span> <b class="conum">(3)</b>
    tokenUri <span class="string"><span class="delimiter">&quot;</span><span class="content">https://asm.acme.com/auth/realms/asm/protocol/openid-connect/token</span><span class="delimiter">&quot;</span></span><b class="conum">(4)</b>
    url <span class="string"><span class="delimiter">&quot;</span><span class="content">https://asm.acme.com/adm/api</span><span class="delimiter">&quot;</span></span><b class="conum">(5)</b>
    namespace <span class="string"><span class="delimiter">'</span><span class="content">MyProject</span><span class="delimiter">'</span></span> <b class="conum">(6)</b>
    domain <span class="string"><span class="delimiter">'</span><span class="content">MyDomain</span><span class="delimiter">'</span></span><b class="conum">(7)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Place this new task under in the Axiomatics group</p>
</li>
<li>
<p>client id to use for Keycloak authentication</p>
</li>
<li>
<p>client secret to use for Keycloak authentication</p>
</li>
<li>
<p>Keycloak authorization endpoint</p>
</li>
<li>
<p>ADM API endpoint</p>
</li>
<li>
<p>Namespace to push to</p>
</li>
<li>
<p>Domain to push to</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It is possible to create multiple tasks that pushes to different namespaces or domains if you want to upload the domain to different target environments (such as test or prod). Alternatively use environment variables in the above task configuration.
If successfully, the task will print the new domain id returned from the server.</p>
</div>
<div class="paragraph">
<p>If any Axiomatics Decision Service (ADS) is configured to poll for changes of the namespace and domain, it will recieve the updated domain upon a successful push.</p>
</div>
<div class="paragraph">
<p>For more information on how to setup client authentication see <a href="https://docs.axiomatics.com/axiomatics-services-manager/appendix/keycloak/appx-keycloak-client-for-ads/">https://docs.axiomatics.com/axiomatics-services-manager/appendix/keycloak/appx-keycloak-client-for-ads/</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reference_and_further_documentation">Reference and further documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://docs.axiomatics.com">Axiomatics product documentation</a></p>
</div>
<div class="paragraph">
<p><a href="https://axiomatics.github.io/alfa-vscode-doc">https://axiomatics.github.io/alfa-vscode-doc</a> - ALFA language documentation.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/axiomatics/xacml-3.0-authz-service-openapi-spec">XACML 3.0 Authorization Service - OpenAPI specification</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.8<br>
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</body>
</html>